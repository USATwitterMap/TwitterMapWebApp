<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace = "TwitterWordMapper">
   
   <resultMap id = "wordResult" type = "dao.TwitterWord">
	   <result property = "id" column = "id"/>
	   <result property = "state" column = "state"/>
	   <result property = "word" column = "word"/>
	   <result property = "occurances" column = "occurances"/>
	   <result property = "time" column = "time"/>
	</resultMap>

   <select id = "GetWordsDuringTimeByState" resultType="dao.TwitterWord">
   		SELECT state, SUM(occurances) as occurances FROM 
   		Words WHERE time = #{time} AND word = #{word}
   		GROUP BY state ORDER BY state; 
   </select>
</mapper> 